import timeit
import matplotlib.pyplot as plt
import numpy as np

def get_max_drawdown_slow(array):
    drawdowns = []
    for i in range(len(array)):
        max_array = max(array[:i+1])
        drawdown = max_array - array[i]
        drawdowns.append(drawdown)
    return max(drawdowns)

def get_max_drawdown_fast(array):
    drawdowns = []
    max_so_far = array[0]
    for i in range(len(array)):
        if array[i] > max_so_far:
            drawdown = 0
            drawdowns.append(drawdown)
            max_so_far = array[i]
        else:
            drawdown = max_so_far - array[i]
            drawdowns.append(drawdown)
    return max(drawdowns)

np.random.seed(1)
a = np.random.randn(1000)
values = np.cumsum(a)
print (timeit.timeit('get_max_drawdown_slow(values)', setup="from __main__ import get_max_drawdown_slow, values", number=100))
print (timeit.timeit('get_max_drawdown_fast(values)', setup="from __main__ import get_max_drawdown_fast, values", number=100))
print (get_max_drawdown_slow(values))
print (get_max_drawdown_fast(values))
plt.plot(values)
plt.show()
